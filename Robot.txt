// Vehicle Movements such as going forward and coming to halt
plant VehicleMovement:
    controllable start, stop;

    location idle:
        initial; marked;
        edge start goto move;
    location move:
        edge stop goto idle;
end

// Auxiliary Movements are vehicle rotation
plant AuxiliaryMovements:
    controllable rotate, stoprotate;

    location NoRotation:
        initial;
        marked;
        edge rotate goto Rotation;
    location Rotation:
        edge stoprotate goto NoRotation;
end

//Vehicle Lever operation
plant VehicleLever:
    controllable raising, lowering;
    location low:
        initial;
        marked;
        edge raising goto high;
    location high:
    marked;
        edge lowering goto low;
end
// Obstacle Sensor
plant ObstacleSensor:
    uncontrollable TurningOn, TurningOff;
    location off:
        initial; marked;
        edge TurningOn goto on;
    location on:
        edge TurningOff goto off;
end

// Touch Sensor
plant TouchSensor:
    uncontrollable TurningOn, TurningOff;
    location off:
        initial; marked;
        edge TurningOn goto on;
    location on:
        edge TurningOff goto off;
end
// Battery System
plant BatteryLevel:
    uncontrollable Increase, Decrease, Replace;
    location full:
    initial; marked;
        edge Decrease when ChargingSystem.Charging = false goto low;
    location low:
        edge Increase when ChargingSystem.Charging = true goto full;
        edge Decrease when ChargingSystem.Charging = false goto critical;
    location critical:
        edge Replace goto full;
end

plant ChargingSystem:
    controllable StartCharging, StopCharging;
    location idle:
    initial; marked;
        edge StartCharging goto Charging;
    location Charging:
        edge StopCharging goto idle;
end

// Camera Sensor
plant CameraSensor:
    uncontrollable Detected, Scanning;
    location on:
    initial; marked;
        edge Scanning goto off;
    location off:
        edge Detected goto on;
end

// REQUIREMENTS

// Vehicle start and stop when camera location is on
requirement VehicleMovementWhenCameraDetects:
    location idle:
    initial; marked;
    edge VehicleMovement.start when CameraSensor.on ;
    edge VehicleMovement.stop when CameraSensor.on ;
end

// Rotate only when vehicle is in Idle and Camera Sensor is ON
requirement RotateOnlyWhenVehicleIsNotMoving:
    location idle:
        initial;
        marked;
            edge AuxiliaryMovements.rotate when VehicleMovement.idle and CameraSensor.on goto rotate;

    location rotate:
            edge AuxiliaryMovements.stoprotate goto idle;
end

requirement VehicleMovement.start needs AuxiliaryMovements.NoRotation;

// Vehicle lever movement requirement
requirement LeverMovementsWhenVehicleIsIdle:
    location idle:
    initial;
    marked;
        edge VehicleLever.raising when VehicleMovement.idle and AuxiliaryMovements.NoRotation and CameraSensor.on;
        edge VehicleLever.lowering when VehicleMovement.idle and AuxiliaryMovements.NoRotation and CameraSensor.on;
end

// Vehicle Movements when Obstacle and Touch sensor is ON
requirement StopVehicleMovementWhenObstacleSensorIsON:
    location STOP:
    initial; marked;
        edge VehicleMovement.start when ObstacleSensor.off goto MOVE;
    location MOVE:
        edge VehicleMovement.stop goto STOP;
end

requirement StopVehicleMovementWhenTouchSensorIsON:
    location STOP:
    initial; marked;
        edge VehicleMovement.start when TouchSensor.off goto MOVE;
    location MOVE:
        edge VehicleMovement.stop goto STOP;
end

//Charge when Battery is low and vehicle and other movements are idle

requirement ChargeWhenBatteryIsLow:
    location NoCharging:
    initial;
    marked;
    edge ChargingSystem.StartCharging when BatteryLevel.low and VehicleMovement.idle and AuxiliaryMovements.NoRotation goto Charging;
    location Charging:
    edge ChargingSystem.StopCharging when BatteryLevel.full goto NoCharging;
end

// Stop Vehicle Movements while Charging

requirement StopAllMovementsWhenCharging:
    location Deactive:
    initial;marked;
    edge VehicleMovement.start when ChargingSystem.idle ;
    edge VehicleLever.raising when ChargingSystem.idle ;
    edge VehicleLever.lowering when ChargingSystem.idle ;
    edge AuxiliaryMovements.rotate when ChargingSystem.idle ;
end





